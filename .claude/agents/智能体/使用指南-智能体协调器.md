# 智能体协调器使用指南

## 📌 快速开始

### 什么是智能体协调器？

智能体协调器是一个**中央协调系统**，它可以：
- 🎯 **自动分析**你的需求并选择最合适的专业Agent
- 🔄 **智能编排**多个Agent的工作流程
- ⚙️ **服务调度**MCP工具（Serena、Context7等）
- 📊 **结果整合**所有Agent的输出成统一方案

### 三种使用方式

#### 方式 1: 自然语言描述（推荐）
```
用户: "我需要为Vue 3项目添加国际化支持"

协调器自动:
✓ 识别任务类型→全栈开发
✓ 推荐Agent→frontend-dev + backend-dev + fullstack-dev
✓ 编排流程→并行+串行混合
✓ 输出方案→完整的实现指南
```

#### 方式 2: 显式指定Agent
```
用户: "请使用 react-specialist 和 typescript-pro 来优化这个React组件"

协调器:
✓ 直接启动指定的Agent
✓ 管理Agent间的协作
✓ 整合输出结果
```

#### 方式 3: 高级自定义
```
用户: "先做需求分析(product-manager)，然后并行做设计(ui-designer)和前端开发(frontend-developer)"

协调器:
✓ 按指定顺序执行
✓ 精确控制并行度
✓ 提供分阶段结果
```

---

## 🎯 常见场景示例

### 场景 1: 新功能实现

**输入**:
```
"我们需要在Django后端添加一个WebSocket实时推送功能，
前端是Vue 3。预计需要2天完成。"
```

**协调器推荐**:
```json
{
  "需求分析": "全栈新功能开发 + 复杂度中等",
  "推荐Agent": [
    {"序号": 1, "Agent": "websocket-engineer", "任务": "WebSocket服务设计", "时机": "并行开始"},
    {"序号": 1, "Agent": "backend-developer", "任务": "Django集成", "时机": "并行开始"},
    {"序号": 2, "Agent": "frontend-developer", "任务": "Vue 3 UI实现", "时机": "后端完成后开始"},
    {"序号": 3, "Agent": "fullstack-developer", "任务": "集成测试+部署", "时机": "最后阶段"}
  ],
  "执行计划": "阶段1(1.5h)→阶段2(3h)→阶段3(0.5h)",
  "预计总时间": "5小时",
  "MCP服务": ["serena(代码分析)", "playwright(E2E测试)", "sequential_thinking(架构决策)"]
}
```

**最终交付**:
- ✅ Django WebSocket 服务完整实现
- ✅ Vue 3 实时推送UI组件
- ✅ 端到端集成测试
- ✅ 部署指南和性能优化建议

---

### 场景 2: 性能问题诊断

**输入**:
```
"我的React应用在处理1000+条数据时变得非常慢，首屏加载要10秒。"
```

**协调器推荐**:
```json
{
  "需求分析": "性能优化 + 复杂度中等",
  "推荐Agent": [
    {"Agent": "performance-engineer", "任务": "性能分析和瓶颈识别"},
    {"Agent": "react-specialist", "任务": "组件优化"},
    {"Agent": "database-optimizer", "任务": "查询优化（如果适用）"},
    {"Agent": "build-engineer", "任务": "构建和包体积优化"}
  ],
  "MCP服务编排": [
    "browser.lighthouse → 综合性能评分",
    "sequential_thinking → 瓶颈分析",
    "serena → 代码定位",
    "playwright → 优化前后对比测试"
  ],
  "预期结果": "首屏加载 < 3秒, 数据处理帧率 > 60fps"
}
```

**最终交付**:
- ✅ 性能诊断报告（具体瓶颈+数据对比）
- ✅ 优化方案（代码级+构建级+架构级）
- ✅ 实现代码和配置
- ✅ 验证测试用例

---

### 场景 3: 代码审查与重构

**输入**:
```
"这是一个3年前写的Python后端项目，现在想重构一下，确保代码质量。"
```

**协调器推荐**:
```json
{
  "需求分析": "代码审查+重构 + 复杂度中等",
  "推荐Agent": [
    {"Agent": "code-reviewer", "任务": "代码质量评审"},
    {"Agent": "refactoring-specialist", "任务": "重构方案设计"},
    {"Agent": "python-pro", "任务": "现代Python最佳实践升级"},
    {"Agent": "test-automator", "任务": "测试覆盖和自动化"},
    {"Agent": "documentation-engineer", "任务": "文档完善"}
  ],
  "执行流程": "并行评审→设计方案→实施重构→测试验证→文档更新",
  "预期成果": "代码评分从D升至A"
}
```

**最终交付**:
- ✅ 详细的代码审查报告
- ✅ 分步骤的重构计划
- ✅ 现代化的Python代码
- ✅ 单元测试和集成测试
- ✅ 完整的API文档

---

### 场景 4: 架构设计咨询

**输入**:
```
"我们的服务要支持100万日活用户，目前是单体架构。
考虑迁移到微服务，想听听专家意见。"
```

**协调器推荐**:
```json
{
  "需求分析": "架构设计 + 复杂度高",
  "推荐Agent": [
    {"Agent": "architect-reviewer", "任务": "现有架构分析"},
    {"Agent": "microservices-architect", "任务": "微服务方案设计"},
    {"Agent": "cloud-architect", "任务": "云基础设施规划"},
    {"Agent": "devops-engineer", "任务": "部署和运维方案"},
    {"Agent": "sre-engineer", "任务": "可靠性和监控"}
  ],
  "交付物": [
    "现状分析报告",
    "微服务架构设计图",
    "迁移路线图（分阶段）",
    "成本估算",
    "风险评估和应对方案"
  ]
}
```

**最终交付**:
- ✅ 详细的架构设计文档
- ✅ 系统架构图（多个视图）
- ✅ 分阶段迁移方案（3-6个月）
- ✅ 成本-收益分析
- ✅ 实施风险评估

---

## 🔧 工作流详解

### 完整流程

```
1️⃣ 需求输入
   用户: "我需要..."
   ↓
2️⃣ 智能分析
   - 识别任务类型（功能开发/优化/设计等）
   - 评估复杂度（简单/中等/复杂/超复杂）
   - 分析依赖关系（哪些任务可并行）
   ↓
3️⃣ Agent推荐
   - 从10大类100+个Agent中筛选
   - 形成最优组合
   - 展示推荐理由
   ↓
4️⃣ 工作流编排
   - 确定执行顺序和并行度
   - 分配Token预算和执行时间
   - 激活MCP服务
   ↓
5️⃣ 并行执行
   - 多个Agent同时或顺序工作
   - 实时监控执行状态
   - 及时处理异常
   ↓
6️⃣ 结果整合
   - 收集所有Agent的输出
   - 验证一致性和完整性
   - 解决可能的矛盾
   ↓
7️⃣ 最终交付
   - 统一的解决方案
   - 完整的文档和代码
   - 使用指南和最佳实践
   ↓
8️⃣ 反馈优化
   - 收集用户反馈
   - 评估协调效果
   - 优化未来策略
```

### 每个阶段的用户交互

```
需求输入
  └─ 用户描述需求 (自然语言)
  └─ 确认理解无误 (协调器确认)

Agent推荐
  └─ 展示推荐组合 (表格或清单)
  └─ 解释推荐理由 (为什么选这些Agent)
  └─ 邀请用户反馈 (接受修改建议)

工作流编排
  └─ 展示执行计划 (甘特图或流程图)
  └─ 确认时间预估 (可行性评估)
  └─ 获得执行授权 (开始执行)

执行进行中
  └─ 实时进度更新 (10-15分钟更新一次)
  └─ 重要里程碑通知 (阶段完成)
  └─ 异常处理 (如遇到阻碍)

结果呈现
  └─ 分阶段展示成果 (不等所有Agent完成)
  └─ 解释关键决策 (为什么这样设计)
  └─ 邀请反馈修改 (可以要求调整)

最终交付
  └─ 完整方案文档
  └─ 实施代码（如适用）
  └─ 后续维护建议
  └─ 关键知识点总结
```

---

## 🚀 高级技巧

### 1. 加速任务完成

**需求**: 时间紧张，需要尽快完成
```
用户: "这个功能很急，下午4点要上线，怎样能最快完成？"

协调器的处理:
✓ 优先并行执行（不限于1个Agent并行）
✓ 关键路径优化（识别最长链路）
✓ 精简交付物（MVP vs 完整功能）
✓ 自动化测试（跳过手动验证步骤）

预期: 减少20-40%的时间
```

### 2. 渐进式开发

**需求**: 先做最小可行产品，后续逐步完善
```
用户: "先实现核心功能，其他的后续再说"

协调器的处理:
第一阶段(MVP): core-developers + minimal-testing
    目标: 最快验证想法
    时间: 1-2天

第二阶段(增强): optimize-agents + performance-engineer
    目标: 性能和用户体验
    时间: 3-5天

第三阶段(完善): security-engineer + documentation-engineer
    目标: 生产就绪
    时间: 2-3天

总时间: 1-2周（比一次性完成快）
```

### 3. 技术栈匹配

**需求**: 自动选择符合你的技术栈的Agent
```
用户: "我的项目是 Vue 3 + Django + PostgreSQL"

协调器自动:
✓ 前端Agent: vue-expert, typescript-pro
✓ 后端Agent: django-developer, python-pro
✓ 数据库Agent: postgres-pro, sql-pro

无需手动指定，自动识别!
```

### 4. 跳过不需要的步骤

**需求**: 我只需要代码，不需要设计
```
用户: "跳过UI设计，直接进行开发"

协调器的处理:
去掉: ui-designer, ux-researcher
保留: frontend-developer, backend-developer

简化工作流，节省时间
```

### 5. 自定义并行度

**需求**: 控制同时工作的Agent数量
```
用户: "我想最多3个Agent并行，不要太多"

协调器的处理:
限制同时执行的Agent为3个
按优先级排队其他Agent

适合:
- 系统资源有限
- 信息沟通困难
- 需要更强的质量控制
```

---

## 📊 Agent选择速查表

### 按开发角色

| 我的角色 | 推荐Agent | 场景 |
|---------|---------|------|
| 前端工程师 | frontend-developer, react-specialist, vue-expert | UI实现、性能优化、交互开发 |
| 后端工程师 | backend-developer, spring-boot-engineer, python-pro | API设计、数据库优化、服务开发 |
| 全栈工程师 | fullstack-developer | 从数据库到UI的完整功能 |
| 运维工程师 | devops-engineer, kubernetes-specialist, terraform-engineer | 部署、CI/CD、基础设施 |
| 数据工程师 | data-engineer, database-optimizer, sql-pro | 数据管道、性能优化、分析 |
| 测试工程师 | qa-expert, test-automator, penetration-tester | 自动化测试、性能测试、安全测试 |
| 技术主管 | architect-reviewer, project-manager, product-manager | 架构审查、项目管理、产品规划 |

### 按技术领域

| 技术领域 | 推荐Agent | 备选 |
|---------|---------|------|
| React生态 | react-specialist | nextjs-developer, typescript-pro |
| Vue生态 | vue-expert | nuxt-specialist, typescript-pro |
| Python | python-pro | django-developer, data-scientist |
| Java/Spring | spring-boot-engineer | java-architect, microservices-architect |
| Kubernetes | kubernetes-specialist | devops-engineer, cloud-architect |
| GraphQL | graphql-architect | api-designer, backend-developer |
| 微服务 | microservices-architect | backend-developer, devops-engineer |
| 云平台 | cloud-architect | devops-engineer, terraform-engineer |
| 性能优化 | performance-engineer | database-optimizer, build-engineer |
| 安全 | security-engineer | penetration-tester, security-auditor |

### 按任务类型

| 任务类型 | 推荐Agent | 优先级 |
|---------|---------|--------|
| 新功能实现 | fullstack-developer | 必须 |
| 代码审查 | code-reviewer | 高 |
| 性能优化 | performance-engineer | 高 |
| 问题诊断 | debugger | 高 |
| 架构设计 | architect-reviewer | 高 |
| 文档编写 | documentation-engineer | 中 |
| 安全审计 | security-engineer | 中 |
| 测试自动化 | test-automator | 中 |
| 重构升级 | refactoring-specialist | 低 |
| 依赖管理 | dependency-manager | 低 |

---

## 🔍 故障排除

### 问题 1: "推荐的Agent不是我想要的"

**解决方案**:
```
用户: "我想用X Agent而不是Y"

协调器:
✓ 直接使用你指定的Agent
✓ 解释X的优势和劣势
✓ 记录这个偏好以优化未来推荐
```

### 问题 2: "任务执行太慢"

**解决方案**:
```
检查清单:
✓ 是否可以增加并行度？
✓ 是否有冗余的Agent可以去掉？
✓ 是否可以简化交付物（MVP vs完整）？
✓ 是否需要跳过某些步骤（测试/文档）？
```

### 问题 3: "Agent的输出不符合要求"

**解决方案**:
```
协调器的处理:
1. 检查是否传达清楚了需求
2. 尝试换个Agent重做
3. 提供具体的修改建议
4. 反复迭代直到满意
```

### 问题 4: "多个Agent的输出互相矛盾"

**解决方案**:
```
协调器的处理:
1. 识别矛盾点
2. 分析每个观点的合理性
3. 提出综合方案
4. 邀请用户选择或仲裁

例如:
- Agent A建议用微服务
- Agent B建议用单体
- 折中: 先单体+良好的模块划分，后续再考虑拆分
```

---

## 💡 最佳实践

### DO ✅

- **早期沟通** - 启动前充分描述需求
- **阶段验收** - 各阶段完成后及时验收，及早发现问题
- **明确期望** - 说清楚时间、质量、范围的优先级
- **信任Agent** - 相信推荐的Agent的专业性
- **提供反馈** - 不满意时及时反馈，协调器会调整
- **记录决策** - 记下为什么选某个方案，便于学习

### DON'T ❌

- **含糊其辞** - 需求描述不清会导致推荐偏差
- **频繁变更** - 中途改需求会导致时间成倍增加
- **过度协调** - 简单任务不需要多个Agent
- **忽视风险** - 高风险项目需要加入security-engineer
- **缺少测试** - 任何功能都应该有相应的测试
- **忽视文档** - 代码完成后补文档通常效果不好

---

## 📞 需要帮助？

- **看不懂某个Agent的能力**: 问协调器 "Agent X 适合做什么？"
- **不知道用哪个Agent**: 描述你的需求，协调器会自动推荐
- **想组织多个Agent协作**: 说出你的想法，协调器会编排
- **想查看执行进度**: 要求 "显示当前的执行进度和时间预估"
- **有其他建议**: 欢迎反馈，协调器会不断学习和优化

---

**记住**: 智能体协调器的目标是让你专注于需求，而不是被繁琐的Agent选择和协调困扰。充分利用它的力量！

