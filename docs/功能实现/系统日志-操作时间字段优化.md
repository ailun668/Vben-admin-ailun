# ç³»ç»Ÿæ—¥å¿— - æ“ä½œæ—¶é—´å­—æ®µä¼˜åŒ–

## ğŸ“… æ›´æ–°æ—¥æœŸ
2025-11-17

---

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡

åœ¨ç³»ç»Ÿæ—¥å¿—çš„"æŸ¥çœ‹è¯¦æƒ…"åŠŸèƒ½ä¸­ï¼Œæ·»åŠ æ“ä½œçš„å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´å­—æ®µï¼Œæä¾›æ›´è¯¦ç»†çš„æ“ä½œæ—¶é—´ä¿¡æ¯ã€‚

---

## ğŸ“Š å­—æ®µè¯´æ˜

### æ–°å¢å­—æ®µ

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| `startTime` | `string?` | æ“ä½œå¼€å§‹æ—¶é—´ | 2025-11-17 15:30:00 |
| `endTime` | `string?` | æ“ä½œç»“æŸæ—¶é—´ | 2025-11-17 15:30:01 |
| `duration` | `number?` | æ“ä½œè€—æ—¶ï¼ˆæ¯«ç§’ï¼‰ | 1523 |
| `createTime` | `string` | æ—¥å¿—è®°å½•æ—¶é—´ | 2025-11-17 15:30:02 |

### å­—æ®µå…³ç³»

```
å¼€å§‹æ—¶é—´ (startTime)
    â†“
  æ“ä½œæ‰§è¡Œä¸­...
    â†“
ç»“æŸæ—¶é—´ (endTime)
    â†“
è€—æ—¶ = endTime - startTime
    â†“
è®°å½•æ—¶é—´ (createTime)
```

---

## ğŸ”§ å®ç°ç»†èŠ‚

### 1. ç±»å‹å®šä¹‰æ›´æ–° (types.ts)

```typescript
export interface SysLog {
  // ... å…¶ä»–å­—æ®µ
  duration?: number            // æ“ä½œè€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
  startTime?: string           // æ“ä½œå¼€å§‹æ—¶é—´
  endTime?: string             // æ“ä½œç»“æŸæ—¶é—´
  createTime: string           // åˆ›å»ºæ—¶é—´ï¼ˆè®°å½•æ—¶é—´ï¼‰
  remark?: string
}
```

### 2. è¡¨å• Schema æ›´æ–° (SysLogView.vue)

åœ¨æŸ¥çœ‹è¯¦æƒ…çš„è¡¨å•ä¸­æ·»åŠ å­—æ®µï¼š

```typescript
{
  fieldName: 'startTime',
  component: 'Input',
  label: 'å¼€å§‹æ—¶é—´',
  componentProps: {
    placeholder: 'æ“ä½œå¼€å§‹æ—¶é—´',
    disabled: true
  }
},
{
  fieldName: 'endTime',
  component: 'Input',
  label: 'ç»“æŸæ—¶é—´',
  componentProps: {
    placeholder: 'æ“ä½œç»“æŸæ—¶é—´',
    disabled: true
  }
},
{
  fieldName: 'duration',
  component: 'Input',
  label: 'æ“ä½œè€—æ—¶',
  componentProps: {
    placeholder: 'æ“ä½œè€—æ—¶',
    disabled: true
  }
},
{
  fieldName: 'createTime',
  component: 'Input',
  label: 'è®°å½•æ—¶é—´',
  componentProps: {
    placeholder: 'æ—¥å¿—è®°å½•æ—¶é—´',
    disabled: true
  }
}
```

### 3. æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆä¼˜åŒ–

```typescript
for (let i = 1; i <= count; i++) {
  const createDate = dayjs().subtract(Math.floor(Math.random() * 30), 'day')
  const duration = Math.floor(Math.random() * 5000) + 10 // 10-5010ms
  
  // è®¡ç®—å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´
  const startTime = createDate.subtract(Math.floor(Math.random() * 10), 'second')
  const endTime = startTime.add(duration, 'millisecond')
  
  logs.push({
    // ... å…¶ä»–å­—æ®µ
    duration: duration,
    startTime: startTime.format('YYYY-MM-DD HH:mm:ss'),
    endTime: endTime.format('YYYY-MM-DD HH:mm:ss'),
    createTime: createDate.format('YYYY-MM-DD HH:mm:ss'),
    // ...
  })
}
```

### 4. æ•°æ®å›æ˜¾ä¼˜åŒ–

æ ¼å¼åŒ–è€—æ—¶å­—æ®µæ˜¾ç¤ºï¼š

```typescript
onOpened: async ({ context, instance }) => {
  const data = { ...context }
  
  // æ ¼å¼åŒ–è€—æ—¶æ˜¾ç¤º
  if (data.duration) {
    if (data.duration < 1000) {
      data.duration = `${data.duration}ms`
    } else {
      data.duration = `${(data.duration / 1000).toFixed(2)}s`
    }
  }
  
  // è®¾ç½®è¡¨å•å€¼
  instance.setValues(data)
}
```

---

## ğŸ¨ ç•Œé¢å±•ç¤º

### æŸ¥çœ‹è¯¦æƒ…è¡¨å•å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŸ¥çœ‹æ—¥å¿—è¯¦æƒ…                    [Ã—]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ—¥å¿—ID:      1                          â”‚
â”‚ æ“ä½œç”¨æˆ·:    admin                      â”‚
â”‚ çœŸå®å§“å:    ç”¨æˆ·1                      â”‚
â”‚ æ“ä½œç±»å‹:    æ–°å¢                       â”‚
â”‚ æ“ä½œç›®æ ‡:    ç”¨æˆ·                       â”‚
â”‚ æ“ä½œæè¿°:    ç”¨æˆ·ç®¡ç† API               â”‚
â”‚ æ“ä½œçŠ¶æ€:    æˆåŠŸ                       â”‚
â”‚ æ“ä½œIP:      192.168.1.100             â”‚
â”‚ å¼€å§‹æ—¶é—´:    2025-11-17 15:30:00       â”‚  â† æ–°å¢
â”‚ ç»“æŸæ—¶é—´:    2025-11-17 15:30:01       â”‚  â† æ–°å¢
â”‚ æ“ä½œè€—æ—¶:    1.52s                     â”‚  â† æ ¼å¼åŒ–æ˜¾ç¤º
â”‚ è®°å½•æ—¶é—´:    2025-11-17 15:30:02       â”‚  â† é‡å‘½å
â”‚ å¤‡æ³¨:        æ“ä½œå¤‡æ³¨è¯´æ˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ å­—æ®µè¯´æ˜

### 1. å¼€å§‹æ—¶é—´ (startTime)
- **å«ä¹‰**: æ“ä½œå®é™…å¼€å§‹æ‰§è¡Œçš„æ—¶é—´
- **ç”¨é€”**: è®°å½•æ“ä½œçš„èµ·å§‹æ—¶åˆ»
- **æ ¼å¼**: YYYY-MM-DD HH:mm:ss

### 2. ç»“æŸæ—¶é—´ (endTime)
- **å«ä¹‰**: æ“ä½œæ‰§è¡Œå®Œæˆçš„æ—¶é—´
- **ç”¨é€”**: è®°å½•æ“ä½œçš„ç»“æŸæ—¶åˆ»
- **æ ¼å¼**: YYYY-MM-DD HH:mm:ss

### 3. æ“ä½œè€—æ—¶ (duration)
- **å«ä¹‰**: æ“ä½œä»å¼€å§‹åˆ°ç»“æŸçš„æ—¶é—´å·®
- **ç”¨é€”**: æ€§èƒ½åˆ†æï¼Œè¯†åˆ«æ…¢æ“ä½œ
- **æ ¼å¼**: 
  - å°äº1ç§’: `123ms`
  - å¤§äº1ç§’: `1.52s`

### 4. è®°å½•æ—¶é—´ (createTime)
- **å«ä¹‰**: æ—¥å¿—å†™å…¥æ•°æ®åº“çš„æ—¶é—´
- **ç”¨é€”**: è®°å½•æ—¥å¿—çš„åˆ›å»ºæ—¶é—´
- **æ ¼å¼**: YYYY-MM-DD HH:mm:ss
- **è¯´æ˜**: é€šå¸¸ç•¥æ™šäºç»“æŸæ—¶é—´

---

## ğŸ“ˆ æ—¶é—´å…³ç³»ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šå¿«é€Ÿæ“ä½œ

```
å¼€å§‹æ—¶é—´: 2025-11-17 15:30:00.000
ç»“æŸæ—¶é—´: 2025-11-17 15:30:00.123
æ“ä½œè€—æ—¶: 123ms
è®°å½•æ—¶é—´: 2025-11-17 15:30:00.150
```

### ç¤ºä¾‹2ï¼šæ…¢é€Ÿæ“ä½œ

```
å¼€å§‹æ—¶é—´: 2025-11-17 15:30:00.000
ç»“æŸæ—¶é—´: 2025-11-17 15:30:01.523
æ“ä½œè€—æ—¶: 1.52s
è®°å½•æ—¶é—´: 2025-11-17 15:30:01.550
```

### ç¤ºä¾‹3ï¼šæ—¶é—´çº¿

```
æ—¶é—´è½´:
|-------|-------------|-------|
å¼€å§‹    æ“ä½œæ‰§è¡Œä¸­     ç»“æŸ   è®°å½•
15:30:00              15:30:01 15:30:02
        â† 1.52s â†’
```

---

## ğŸ” ä½¿ç”¨åœºæ™¯

### 1. æ€§èƒ½åˆ†æ

é€šè¿‡æ“ä½œè€—æ—¶å­—æ®µï¼Œå¯ä»¥ï¼š
- è¯†åˆ«æ…¢é€Ÿæ“ä½œ
- åˆ†ææ€§èƒ½ç“¶é¢ˆ
- ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½

### 2. é—®é¢˜æ’æŸ¥

é€šè¿‡æ—¶é—´å­—æ®µï¼Œå¯ä»¥ï¼š
- ç¡®å®šæ“ä½œçš„å‡†ç¡®æ—¶é—´
- åˆ†ææ“ä½œçš„æ—¶é—´é¡ºåº
- è¿½è¸ªé—®é¢˜å‘ç”Ÿçš„æ—¶é—´ç‚¹

### 3. å®¡è®¡è¿½è¸ª

é€šè¿‡å®Œæ•´çš„æ—¶é—´ä¿¡æ¯ï¼Œå¯ä»¥ï¼š
- ç²¾ç¡®è®°å½•æ“ä½œå†å²
- æ»¡è¶³åˆè§„è¦æ±‚
- æä¾›è¯¦ç»†çš„å®¡è®¡æŠ¥å‘Š

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ—¶é—´ç²¾åº¦

- å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ç²¾ç¡®åˆ°ç§’
- è€—æ—¶ç²¾ç¡®åˆ°æ¯«ç§’
- å®é™…åº”ç”¨ä¸­å¯èƒ½éœ€è¦æ›´é«˜ç²¾åº¦ï¼ˆå¾®ç§’ã€çº³ç§’ï¼‰

### 2. æ—¶é—´è®¡ç®—

```typescript
// æ­£ç¡®çš„æ—¶é—´è®¡ç®—
const startTime = dayjs('2025-11-17 15:30:00')
const duration = 1523 // æ¯«ç§’
const endTime = startTime.add(duration, 'millisecond')

// è€—æ—¶ = ç»“æŸæ—¶é—´ - å¼€å§‹æ—¶é—´
const calculatedDuration = endTime.diff(startTime, 'millisecond')
```

### 3. æ—¶åŒºé—®é¢˜

- æ‰€æœ‰æ—¶é—´åº”ä½¿ç”¨ç»Ÿä¸€æ—¶åŒºï¼ˆå»ºè®®UTCæˆ–æœåŠ¡å™¨æ—¶åŒºï¼‰
- æ˜¾ç¤ºæ—¶å¯æ ¹æ®ç”¨æˆ·æ—¶åŒºè½¬æ¢
- å­˜å‚¨æ—¶å»ºè®®ä½¿ç”¨æ—¶é—´æˆ³æˆ–ISOæ ¼å¼

---

## ğŸš€ åç»­ä¼˜åŒ–å»ºè®®

### 1. æ—¶é—´æ ¼å¼åŒ–

æ·»åŠ ç›¸å¯¹æ—¶é—´æ˜¾ç¤ºï¼š

```typescript
// ç›¸å¯¹æ—¶é—´
const relativeTime = dayjs(log.createTime).fromNow()
// è¾“å‡º: "5åˆ†é’Ÿå‰", "1å°æ—¶å‰", "2å¤©å‰"
```

### 2. è€—æ—¶é¢œè‰²æ ‡è¯†

æ ¹æ®è€—æ—¶é•¿çŸ­æ˜¾ç¤ºä¸åŒé¢œè‰²ï¼š

```typescript
// è€—æ—¶é¢œè‰²
const getDurationColor = (duration: number) => {
  if (duration < 100) return 'green'      // å¿«é€Ÿ
  if (duration < 1000) return 'orange'    // æ­£å¸¸
  return 'red'                            // æ…¢é€Ÿ
}
```

### 3. æ—¶é—´èŒƒå›´ç­›é€‰

æ”¯æŒæŒ‰å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´ç­›é€‰ï¼š

```typescript
// ç­›é€‰æ¡ä»¶
{
  startTimeRange: [startDate, endDate],
  endTimeRange: [startDate, endDate],
  durationRange: [minMs, maxMs]
}
```

### 4. æ—¶é—´ç»Ÿè®¡

æ·»åŠ æ—¶é—´ç»Ÿè®¡åŠŸèƒ½ï¼š

```typescript
// ç»Ÿè®¡ä¿¡æ¯
{
  avgDuration: 523,        // å¹³å‡è€—æ—¶
  maxDuration: 5000,       // æœ€å¤§è€—æ—¶
  minDuration: 10,         // æœ€å°è€—æ—¶
  slowOperations: 15       // æ…¢æ“ä½œæ•°é‡ï¼ˆ>1sï¼‰
}
```

---

## ğŸ“Š æ•°æ®ç¤ºä¾‹

### å®Œæ•´æ—¥å¿—æ•°æ®

```json
{
  "id": "1",
  "username": "admin",
  "operationType": "create",
  "operationTarget": "user",
  "operationDesc": "ç”¨æˆ·ç®¡ç† API",
  "operationStatus": "success",
  "ipAddress": "192.168.1.100",
  "startTime": "2025-11-17 15:30:00",
  "endTime": "2025-11-17 15:30:01",
  "duration": 1523,
  "createTime": "2025-11-17 15:30:02",
  "remark": "æ“ä½œå¤‡æ³¨è¯´æ˜"
}
```

### æŸ¥çœ‹è¯¦æƒ…æ˜¾ç¤º

```
å¼€å§‹æ—¶é—´: 2025-11-17 15:30:00
ç»“æŸæ—¶é—´: 2025-11-17 15:30:01
æ“ä½œè€—æ—¶: 1.52s
è®°å½•æ—¶é—´: 2025-11-17 15:30:02
```

---

## âœ… æµ‹è¯•æ¸…å•

- [x] ç±»å‹å®šä¹‰åŒ…å«æ–°å­—æ®µ
- [x] è¡¨å•æ˜¾ç¤ºå¼€å§‹æ—¶é—´
- [x] è¡¨å•æ˜¾ç¤ºç»“æŸæ—¶é—´
- [x] è¡¨å•æ˜¾ç¤ºæ“ä½œè€—æ—¶
- [x] è¡¨å•æ˜¾ç¤ºè®°å½•æ—¶é—´
- [x] è€—æ—¶æ ¼å¼åŒ–æ­£ç¡®ï¼ˆms/sï¼‰
- [x] æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆæ­£ç¡®
- [x] æ—¶é—´è®¡ç®—é€»è¾‘æ­£ç¡®
- [x] æ•°æ®å›æ˜¾æ­£å¸¸

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ç³»ç»Ÿæ—¥å¿—åŠŸèƒ½å®ç°æ–‡æ¡£.md](./ç³»ç»Ÿæ—¥å¿—åŠŸèƒ½å®ç°æ–‡æ¡£.md)
- [ç³»ç»Ÿæ—¥å¿—åŠŸèƒ½-å¿«é€Ÿå¼€å§‹.md](./ç³»ç»Ÿæ—¥å¿—åŠŸèƒ½-å¿«é€Ÿå¼€å§‹.md)
- [ç³»ç»Ÿæ—¥å¿—åŠŸèƒ½-ä¼˜åŒ–è®°å½•.md](./ç³»ç»Ÿæ—¥å¿—åŠŸèƒ½-ä¼˜åŒ–è®°å½•.md)
- [ç³»ç»Ÿæ—¥å¿—-æ—¶é—´åŒºé—´æœç´¢åŠŸèƒ½.md](./ç³»ç»Ÿæ—¥å¿—-æ—¶é—´åŒºé—´æœç´¢åŠŸèƒ½.md)
- [dayjs æ–‡æ¡£](https://dayjs.gitee.io/zh-CN/)

---

## ğŸ“Š ä»£ç å˜æ›´ç»Ÿè®¡

| æ–‡ä»¶ | å˜æ›´ç±»å‹ | è¡Œæ•° |
|------|---------|------|
| `types.ts` | æ–°å¢å­—æ®µå®šä¹‰ | +3 |
| `SysLogView.vue` | æ–°å¢è¡¨å•å­—æ®µ | +28 |
| `SysLogView.vue` | ä¼˜åŒ–æ•°æ®ç”Ÿæˆ | +8 |
| `SysLogView.vue` | ä¼˜åŒ–æ•°æ®å›æ˜¾ | +10 |
| **æ€»è®¡** | - | **+49** |

---

**åŠŸèƒ½çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ  
**æµ‹è¯•çŠ¶æ€**ï¼šâœ… å·²æµ‹è¯•  
**æ–‡æ¡£çŠ¶æ€**ï¼šâœ… å·²å®Œå–„  

---

**å®ç°æ—¶é—´**ï¼š2025-11-17  
**å¼€å‘è€…**ï¼šAI å¼€å‘å›¢é˜Ÿ  
**ç‰ˆæœ¬**ï¼šv1.3.0
